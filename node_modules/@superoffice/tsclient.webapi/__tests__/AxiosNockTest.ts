import * as assert from "assert";
import axios from "axios";
import nock = require("nock");

const host: string = "http://localhost";

axios.defaults.baseURL = host;

describe("WebAPI Axios nock tests", () => {
	it("test ok with Nock", done => {
		nock(host).get("/test").reply(200, "test data");

		axios.get("/test").then(response => {
			assert.equal(response.data, "test data");
			done();
		});
	});

	it("test 404 with Nock", done => {
		nock(host).get("/test").reply(404, "fail data");

		axios.get("/test").catch(error => {
			assert.equal(error.response.status, "404");
			assert.equal(error.response.data, "fail data");
			done();
		});
	});
});
